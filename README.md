# 🏪 KCSポータル

木更津コンセプトストア向けのスタッフ情報共有・教育支援Webアプリケーションです。

## 📋 プロジェクト概要

このアプリは、店舗スタッフの教育・トレーニングを効率化し、業務品質を向上させるために設計されました。Googleフォーム＋スプレッドシートのような使いやすさで、動画マニュアル、チェックシート、テスト、ランキング機能を統合しています。

## ✨ 主な機能

### 1. 🏠 ホーム画面（起動画面）
- **Google口コミリンク**
  - ワンクリックで木更津コンセプトストアのGoogle口コミページへアクセス
  - 店舗の評価を簡単に確認
- **管理者からの連絡事項**
  - 重要なお知らせを一覧表示
  - 優先度表示（高・中・低）
  - ピン留め機能で重要な連絡を常に上部に表示
  - タイムスタンプ付きで投稿日時を確認
- **最近の更新（NEW!）**
  - 連絡事項、動画、チェック項目、テスト問題の更新履歴を表示
  - 最新3件を時系列で表示
  - 「◯分前」「◯時間前」などの相対時刻表示

### 2. 📹 動画マニュアル
- **YouTube動画のサムネイル表示（NEW!）**
  - サムネイル画像をクリックで動画再生
  - カスタムサムネイルURL対応
  - YouTubeのデフォルトサムネイル自動取得
  - 限定公開URLに対応
- **モーダル再生**
  - クリックでモーダルウィンドウで再生
  - 動画再生時の自動視聴カウント
- **カテゴリー別フィルタリング**
- **初期設定**: 3本の動画（基礎トレーニング、接客マニュアル、安全管理）
- **拡張性**: カテゴリー分けで動画を追加可能

### 3. ✅ チェックシート
- **4つのカテゴリー**
  - 開店準備（20項目）
  - 接客対応（20項目）
  - 商品管理（20項目）
  - 閉店作業（20項目）
- **フォーム入力形式**
  - チェックボックスで簡単入力
  - カテゴリー切り替え可能
  - 送信後はデータベースに自動保存

### 4. 📝 テスト
- **選択式テスト（10問）**
  - 店舗業務に関する理解度チェック
  - 即座に結果表示（スコアと正答率）
  - チャレンジ数を自動カウント
- **テスト内容**
  - 開店・閉店業務
  - 接客マナー
  - 商品管理
  - クレーム対応など

### 5. 🏆 ランキング
- **テストチャレンジ数ランキング**
  - ユーザー別のテスト受験回数
  - トップ10を表示
  - 金・銀・銅メダル表示
- **動画視聴回数ランキング**
  - ユーザー別の動画視聴数
  - トップ10を表示
  - モチベーション向上に貢献

### 6. 👨‍💼 管理者ビュー
- **データ一覧表示**
  - チェックシート回答履歴
  - テスト結果一覧
  - 動画視聴履歴
- **CSV出力機能**
  - すべてのデータをCSV形式でダウンロード
  - Excel等で分析可能
  - UTF-8 BOM対応（文字化け防止）

## 🎨 デザイン

- **カラフルで親しみやすいUI**
- **グラデーションとアニメーション効果**
- **レスポンシブデザイン**（PC・タブレット・スマートフォン対応）
- **直感的なタブナビゲーション**

## 🚀 使用方法

### 🔧 初期セットアップ（管理者向け）

#### 1. 初期データの投入
アプリを初めて使用する場合は、初期データを投入する必要があります。

1. URLに `?init=true` を追加してアクセス（例：`https://your-app.com?init=true`）
2. 画面右上に表示される「初期データを投入」ボタンをクリック
3. データ投入完了後、ページをリロード

これにより以下のデータが自動的に登録されます：
- サンプル動画 3本
- チェック項目 80項目（4カテゴリー × 20項目）
- テスト問題 10問

#### 2. YouTube動画URLの設定
1. 管理者タブ → 「動画管理」を開く
2. 各動画の「編集」ボタンをクリック
3. YouTube埋め込みURLを実際の限定公開URLに変更
4. 「更新」ボタンで保存

**YouTube埋め込みURLの取得方法：**
- YouTubeで動画を開く
- 「共有」ボタン → 「埋め込む」を選択
- `<iframe src="https://www.youtube.com/embed/xxxxx"...` の部分をコピー
- `https://www.youtube.com/embed/xxxxx` の形式で貼り付け

### 👥 一般ユーザー向け使用方法

#### 初回起動
1. アプリを開くと、ユーザー名入力画面が表示されます
2. 名前を入力して「開始」ボタンをクリック
3. 自動的に「ホーム」タブが表示されます

### 各機能の使い方

#### 🏠 ホーム
1. Google口コミリンクをクリックして店舗の評価を確認
2. 管理者からの連絡事項を確認
3. ピン留めされた重要な連絡は上部に表示されます

#### 📹 動画マニュアル
1. カテゴリーフィルターで動画を絞り込み
2. 見たい動画をクリックして視聴
3. 視聴記録が自動的に保存されます

#### ✅ チェックシート
1. カテゴリーを選択（開店準備、接客対応、商品管理、閉店作業）
2. 各項目をチェック
3. 「送信」ボタンで回答を保存

#### 📝 テスト
1. 全10問の選択式問題に回答
2. 「テスト送信」ボタンをクリック
3. 結果が即座に表示されます

#### 🏆 ランキング
- タブを開くだけで最新のランキングを確認できます
- 自分の順位とトップユーザーを確認しましょう

#### 👨‍💼 管理者
管理者タブでは5つのサブタブがあります：

**1. データ確認タブ**
- チェックシート回答、テスト結果、動画視聴履歴の一覧表示
- タイムスタンプ付きでデータを確認
- 各データをCSV形式でダウンロード可能

**2. 連絡事項管理タブ**（NEW!）
- 「新規連絡事項追加」ボタンで連絡事項を作成
- タイトル、内容、優先度（高・中・低）を設定
- ピン留めチェックボックスで重要な連絡を固定表示
- 各連絡事項の「編集」で内容を変更
- 「削除」ボタンで不要な連絡を削除
- 変更は即座にホーム画面に反映

**3. 動画管理タブ**
- 「新規動画追加」ボタンで動画を追加
- 各動画の「編集」ボタンでタイトル、URL、カテゴリー、表示順を変更
- 「削除」ボタンで不要な動画を削除

**4. チェック項目管理タブ**
- カテゴリー別フィルターでチェック項目を絞り込み
- 「新規項目追加」ボタンで項目を追加
- 各項目の「編集」で内容、カテゴリー、表示順を変更
- 「削除」ボタンで不要な項目を削除

**5. テスト問題管理タブ**
- 「新規問題追加」ボタンでテスト問題を追加
- 問題文、4つの選択肢、正解、表示順を設定
- 各問題の「編集」で内容を変更
- 「削除」ボタンで不要な問題を削除

## 🗂️ ファイル構成

```
/
├── index.html          # メインHTML（編集モーダル含む）
├── css/
│   └── style.css      # スタイルシート（カラフルデザイン、管理者UI）
├── js/
│   ├── init-data.js   # 初期データ投入スクリプト
│   └── app.js         # アプリケーションロジック（編集機能含む）
└── README.md          # このファイル
```

## 💾 データ管理

### データベーステーブル

#### 1. users
- id: ユーザーID
- name: ユーザー名

#### 2. videos（動画マスタ）
- id: 動画ID
- title: 動画タイトル
- youtube_url: YouTube埋め込みURL
- thumbnail_url: サムネイルURL（オプション）NEW!
- category: カテゴリー
- order_num: 表示順

#### 3. video_views（動画視聴履歴）
- id: 視聴記録ID
- user_name: ユーザー名
- video_id: 動画ID
- video_title: 動画タイトル
- viewed_at: 視聴日時（タイムスタンプ）

#### 4. checklist_items（チェック項目マスタ）NEW!
- id: 項目ID
- category: カテゴリー
- item_text: 項目内容
- order_num: 表示順

#### 5. checklist_responses（チェックシート回答履歴）
- id: 回答ID
- user_name: ユーザー名
- category: カテゴリー
- responses: 回答データ（JSON形式）
- submitted_at: 送信日時（タイムスタンプ）

#### 6. test_questions（テスト問題マスタ）NEW!
- id: 問題ID
- question: 問題文
- options: 選択肢（JSON形式、4つ）
- correct_answer: 正解のインデックス（0〜3）
- order_num: 表示順

#### 7. test_responses（テスト回答履歴）
- id: テスト回答ID
- user_name: ユーザー名
- test_name: テスト名
- score: スコア
- total_questions: 総問題数
- responses: 回答データ（JSON形式）
- submitted_at: 送信日時（タイムスタンプ）

#### 8. announcements（連絡事項マスタ）NEW!
- id: 連絡事項ID
- title: タイトル
- content: 内容
- priority: 優先度（高・中・低）
- is_pinned: ピン留めフラグ
- created_at: 作成日時（タイムスタンプ）

## 🔧 技術スタック

- **フロントエンド**: HTML5, CSS3, JavaScript (ES6+)
- **データ管理**: RESTful Table API
- **デザイン**: カスタムCSS（グラデーション、アニメーション）
- **フォント**: Noto Sans JP (Google Fonts)
- **アイコン**: Font Awesome 6.4.0

## 📊 機能URI（エンドポイント）

### データ取得
- `GET tables/videos?limit=100&sort=order_num` - 動画リスト取得
- `GET tables/video_views?limit=1000` - 視聴履歴取得
- `GET tables/checklist_responses?limit=1000` - チェックシート回答取得
- `GET tables/test_responses?limit=1000` - テスト結果取得

### データ登録
- `POST tables/video_views` - 視聴記録登録
- `POST tables/checklist_responses` - チェックシート回答登録
- `POST tables/test_responses` - テスト結果登録

## ✅ 実装済み機能

### 基本機能
- ✅ ユーザー名管理（LocalStorage）
- ✅ タブ切り替えUI
- ✅ 動画マニュアル表示＆カテゴリーフィルター
- ✅ 動画視聴数カウント（タイムスタンプ記録）
- ✅ チェックシート（4カテゴリー×項目数可変）
- ✅ チェックシート送信機能（タイムスタンプ記録）
- ✅ テスト機能（問題数可変、選択式）
- ✅ テスト結果の即時表示（タイムスタンプ記録）
- ✅ テストチャレンジ数ランキング
- ✅ 動画視聴回数ランキング
- ✅ レスポンシブデザイン
- ✅ カラフルなUI/UX

### 管理者機能
- ✅ データ一覧表示（タイムスタンプ付き）
- ✅ CSV出力機能（チェックシート、テスト、動画視聴）
- ✅ **連絡事項管理機能**（NEW!）
  - 連絡事項の追加・編集・削除
  - 優先度設定（高・中・低）
  - ピン留め機能
  - リアルタイムでホーム画面に反映
- ✅ **動画管理機能**
  - 動画の追加・編集・削除
  - YouTube URL設定
  - カテゴリー・表示順の管理
- ✅ **チェック項目管理機能**
  - チェック項目の追加・編集・削除
  - カテゴリー別管理（開店準備、接客対応、商品管理、閉店作業）
  - 表示順の管理
- ✅ **テスト問題管理機能**
  - テスト問題の追加・編集・削除
  - 4択問題の作成
  - 正解設定・表示順の管理

## 🔜 今後の拡張案

### 動画マニュアル
- [x] 管理画面から動画を追加・編集できる機能 ✅ **実装済み**
- [ ] 動画にコメント機能を追加
- [ ] 視聴完了バッジの付与
- [ ] 動画の再生時間トラッキング

### チェックシート
- [x] 管理画面からチェック項目を編集できる機能 ✅ **実装済み**
- [ ] チェック完了率の統計表示
- [ ] 定期的なリマインダー機能
- [ ] 個人別チェック履歴の可視化

### テスト
- [x] 管理画面からテスト問題を編集できる機能 ✅ **実装済み**
- [ ] 複数のテストを作成できる機能
- [ ] 正解・不正解の詳細表示
- [ ] 合格証の発行機能
- [ ] 難易度別テスト
- [ ] テスト結果の詳細分析

### ランキング
- [ ] 期間別ランキング（週間・月間）
- [ ] 部門別ランキング
- [ ] 個人統計ページ

### 管理者機能
- [ ] ダッシュボード（統計グラフ表示）
- [ ] スタッフ管理機能
- [ ] データ分析機能
- [ ] 通知機能

### その他
- [ ] プッシュ通知機能
- [ ] オフライン対応
- [ ] 多言語対応
- [ ] PWA化

## 🎯 推奨される次のステップ

### ステップ1：初期セットアップ
1. **初期データの投入**
   - URLに `?init=true` を追加してアクセス
   - 「初期データを投入」ボタンをクリック
   - ページをリロード

2. **YouTube動画URLの設定**
   - 管理者タブ → 動画管理を開く
   - 各動画を編集して実際の限定公開URLに変更
   - 必要に応じて動画を追加

### ステップ2：カスタマイズ
3. **Google口コミリンクの設定（オプション）**
   - 管理者がソースコードを編集して自店舗の口コミURLに変更可能
   - または、そのまま使用

4. **チェック項目のカスタマイズ**
   - 管理者タブ → チェック項目管理を開く
   - 店舗の実際の業務に合わせて項目を追加・編集・削除
   - 表示順を調整して使いやすくする

5. **テスト問題のカスタマイズ**
   - 管理者タブ → テスト問題管理を開く
   - 実際の業務内容に合わせた問題を追加・編集
   - 難易度バランスを考慮して問題を調整

### ステップ3：運用開始
6. **テスト運用**
   - スタッフに試用してもらう
   - フィードバックを収集
   - UIの改善点を洗い出し

7. **連絡事項の活用**
   - 管理者タブ → 連絡事項管理から定期的に情報を発信
   - 重要な連絡はピン留めで固定表示
   - 優先度を設定して情報の重要性を明確化

8. **データ分析**
   - CSV出力機能を使って定期的にデータを分析
   - ランキングで学習意欲を把握
   - 研修効果を測定

### ステップ4：継続的改善
9. **コンテンツの更新**
   - 連絡事項を定期的に更新
   - 季節や時期に応じて動画を追加
   - 新しい業務内容をチェック項目に追加
   - テスト問題を定期的に更新

10. **機能追加**
   - 上記「今後の拡張案」から優先度の高い機能を実装
   - スタッフからの要望を反映

## 📞 サポート

このアプリは静的Webアプリケーションとして構築されています。
- Google APIとの連携は不要
- RESTful Table APIでデータ管理
- すべての機能がブラウザ上で完結

## 📝 ライセンス

このプロジェクトは店舗内での使用を目的としています。

---

**作成日**: 2025年1月
**バージョン**: 2.0.0
